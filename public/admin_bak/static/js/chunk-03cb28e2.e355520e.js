(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03cb28e2"],{"127f":function(e,t,a){"use strict";a("7f7f"),a("3b2b"),a("a481");var r={dateFormat:function(e,t){var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),"S+":e.getMilliseconds()};for(var r in/(y+)/i.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?a[r]:("00"+a[r]).substr((""+a[r]).length)));return t}},n=a("9b15");t["a"]={randomString:function(e){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],a="",r=0;r<e;r++){var n=Math.ceil(35*Math.random());a+=t[n]}return a},createOssClient:function(){return new Promise(function(e,t){var a=new n({region:"oss-cn-hangzhou",accessKeyId:"LTAIzB8nL0N9FAVz",accessKeySecret:"wxciCikZ58748vfvGHhnGkt8FFaL0i",bucket:"after90s-dev"});e(a)})},ossUploadFile:function(e){var t=e.file,a=this;return new Promise(function(n,o){var s=r.dateFormat(new Date,"yyyyMMdd"),l=r.dateFormat(new Date,"yyyyMMddhhmmss"),i=a.randomString(4),c=t.name.substr(t.name.indexOf(".")),u="video/"+s+"/"+l+"_"+i+c;a.createOssClient().then(function(a){n({fileName:t.name,fileUrl:u}),a.multipartUpload(u,t,{progress:function(t){var a={};a.percent=Math.floor(100*t),e.onProgress(a)}}).then(function(t){if(200===t.res.statusCode)return e.onSuccess(t),t;e.onError("上传失败")},function(t){e.onError("上传失败"),o(t)})})})}}},"4a2e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",[a("el-form",{ref:"form",attrs:{model:e.baseForm,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"基地类型"}},[a("el-col",{attrs:{span:11}},[a("el-select",{attrs:{placeholder:"方案类型"},model:{value:e.baseForm.base_type_id,callback:function(t){e.$set(e.baseForm,"base_type_id",t)},expression:"baseForm.base_type_id"}},e._l(e.baseCategories,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),a("router-link",{attrs:{to:{name:"BaseTypeCreate"}}},[e._v("新建基地分类")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"基地名称"}},[a("el-col",{attrs:{span:11}},[a("el-input",{model:{value:e.baseForm.title,callback:function(t){e.$set(e.baseForm,"title",t)},expression:"baseForm.title"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"基地地址"}},[a("el-col",{attrs:{span:11}},[a("el-input",{model:{value:e.baseForm.address,callback:function(t){e.$set(e.baseForm,"address",t)},expression:"baseForm.address"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"基地特色"}},[a("el-col",{attrs:{span:11}},[a("el-input",{model:{value:e.baseForm.specials,callback:function(t){e.$set(e.baseForm,"specials",t)},expression:"baseForm.specials"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"宣传图片"}},[a("el-col",{attrs:{span:11}},[a("uploader",{attrs:{"file-count":1,"on-success":e.coverUploaded}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"宣传视频"}},[a("el-col",{attrs:{span:11}},[a("uploader",{attrs:{"file-count":1,"on-success":e.videoUploaded}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"相册"}},[a("el-col",{attrs:{span:11}},[a("uploader",{attrs:{"file-count":4,"on-success":e.albumsUploaded}})],1)],1),e._v(" "),a("el-form-item",[a("tinymce",{attrs:{menubar:""},model:{value:e.baseForm.description,callback:function(t){e.$set(e.baseForm,"description",t)},expression:"baseForm.description"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("立即创建")]),e._v(" "),a("el-button",{on:{click:function(t){return e.$router.go(-1)}}},[e._v("取消")])],1)],1)],1)],1)},n=[],o=a("10ba"),s=a("8256"),l=a("fb1e"),i=a("a417"),c={name:"BaseCreate",components:{Tinymce:s["a"],Uploader:o["a"]},data:function(){return{baseCategories:null,baseForm:{base_type_id:null,title:"测试线路"+(new Date).toLocaleDateString(),cover:"",address:"",video:"",albums:"",specials:"",description:""}}},created:function(){var e=this;Object(l["b"])().then(function(t){e.baseCategories=t.data.data})},methods:{onSubmit:function(){var e=this,t=this.transformToFormData(this.baseForm);Object(i["a"])(t).then(function(t){console.log(t),e.$router.go(-1)}).catch(function(t){console.error(t),e.$message.error("创建失败")})},refreshCategory:function(){var e=this;Object(l["b"])().then(function(t){e.baseCategories=t.data.data})},transformToFormData:function(e){var t=new FormData;for(var a in e)t.append(a,e[a]);return t},videoUploaded:function(e){this.baseForm.video=e},albumsUploaded:function(e){this.baseForm.albums=e},coverUploaded:function(e){this.baseForm.cover=e}}},u=c,d=a("2877"),m=Object(d["a"])(u,r,n,!1,null,"24efed0e",null);t["default"]=m.exports},a417:function(e,t,a){"use strict";a.d(t,"c",function(){return n}),a.d(t,"a",function(){return o}),a.d(t,"b",function(){return s});var r=a("b775");function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r["a"])({url:"/base/"+(e||""),method:"GET",data:t})}function o(e){return Object(r["a"])({url:"/base/create",method:"POST",data:e})}function s(e){return Object(r["a"])({url:"/base/"+e,method:"DELETE"})}},fb1e:function(e,t,a){"use strict";a.d(t,"b",function(){return n}),a.d(t,"a",function(){return o}),a.d(t,"c",function(){return s});var r=a("b775");function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r["a"])({url:"/base-type/"+(e||""),method:"GET",data:t})}function o(e){return Object(r["a"])({url:"/base-type/create",method:"POST",data:e})}function s(e){return Object(r["a"])({url:"/base-type/"+e,method:"DELETE"})}}}]);